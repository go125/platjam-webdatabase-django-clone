{% extends "base.html" %} 
{% block extraheader %}
<meta charset="UTF-8">
<title>Quick Start - Leaflet</title>
	
<link rel="shortcut icon" type="image/x-icon" href="docs/images/favicon.ico" />

  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY=" crossorigin=""/>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo=" crossorigin=""></script>

<style>
  html, body {
    height: 100%;
    margin: 0;
  }
  .leaflet-container {
    height: 400px;
    width: 600px;
    max-width: 100%;
    max-height: 100%;
  }
</style>
{% endblock %}
{% block main %} 
<h2>
    店舗マップ
</h2>
<div class="container"><div id="map"></div></div>
<script>
var map = L.map('map');
var tileLayer = L.tileLayer('https://cyberjapandata.gsi.go.jp/xyz/pale/{z}/{x}/{y}.png');
tileLayer.addTo(map);
// https://2ndart.hatenablog.com/entry/2021/04/28/112259 を利用
var place = JSON.parse('{{ data_json|safe }}');
//console.log(place);
iconMarkers = L.featureGroup();		// 全マーカーを画面内に収めるため
for (var i = 0; i < place.length; i++) {
	iconMarkers.addLayer( L.marker([place[i].lat, place[i].lng]).addTo(map).bindPopup(place[i].name) );
}
map.fitBounds(iconMarkers.getBounds());	// 全マーカーを画面内に収める
</script>
{% endblock %}
